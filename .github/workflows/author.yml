name: git_magic

on: [workflow_dispatch]


jobs:
  tasks:
    runs-on: ubuntu-latest
    steps:
    - name: Setup SSH
      uses: MrSquaare/ssh-setup-action@v1
      with:
        host: github.com
        private-key: ${{ secrets.SSH_KEY }}
    - name: Clone
      run: git clone --branch mirror git@github.com:rrrru/abracadabra.git

    - name: Rename
      run: |
        git filter-branch -f --env-filter "
        GIT_AUTHOR_NAME='BranName'
        GIT_AUTHOR_EMAIL='BranName@email'
        GIT_COMMITTER_NAME='BranName'
        GIT_COMMITTER_EMAIL='BranName@email'
        " HEAD

    - name: MR
      run: |
        git remote add origin git@github.com:rrrru/automator.git
        git push origin dev